<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin - Orders</title>
    <link rel="stylesheet" href="/static/style.css" />
    <style>
      body{font-family: system-ui, Arial, sans-serif; margin:0}
      header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#f97316;color:#fff}
      nav a{margin-right:12px;color:#fff;text-decoration:none}
      .container{padding:16px}
      table{width:100%;border-collapse:collapse}
      th,td{border:1px solid #ddd;padding:8px}
      th{background:#fafafa;text-align:left}
      input,select,textarea{padding:6px 8px}
      .btn{padding:6px 10px;border:1px solid #ccc;background:#fff;cursor:pointer}
      .btn-primary{background:#f97316;color:#fff;border-color:#f97316}
      .badge{display:inline-block;padding:2px 6px;border-radius:10px;background:#eee}
    </style>
  </head>
  <body>
    <header>
      <div><strong>AROMA Admin</strong></div>
      <nav>
        <a href="/admin">Dashboard</a>
        <a href="/admin/items">Items</a>
        <a href="/admin/tables">Tables</a>
        <a href="/admin/orders">Orders</a>
        <a href="/admin/settings">Settings</a>
      </nav>
    </header>
    <div class="container">
      <h2>Orders</h2>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Created</th>
      <th>Type</th>
      <th>Table</th>
      <th>Status</th>
      <th>Total</th>
      <th>Payment</th>
      <th>Items</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% orders.forEach(o => { %>
      <tr>
        <td><%= o.id %></td>
        <td><%= o.created_at %></td>
        <td><%= o.order_type %></td>
        <td><%= o.table_number || '-' %></td>
        <td><span class="badge"><%= o.status %></span></td>
        <td>€<%= Number(o.total).toFixed(2) %></td>
        <td><%= (o.payment_method || '-') + ' ' + (o.payment_status || '') %></td>
        <td>
          <ul>
            <% o.items.forEach(i => { %>
              <li><%= i.quantity %> x <%= i.name %> (€<%= Number(i.price).toFixed(2) %>)</li>
            <% }) %>
          </ul>
        </td>
        <td>
          <form method="post" action="/admin/orders/<%= o.id %>/status" style="display:flex; gap:6px">
            <select name="status">
              <option value="received" <%= o.status==='received'?'selected':'' %>>received</option>
              <option value="confirmed" <%= o.status==='confirmed'?'selected':'' %>>confirmed</option>
              <option value="completed" <%= o.status==='completed'?'selected':'' %>>completed</option>
              <option value="cancelled" <%= o.status==='cancelled'?'selected':'' %>>cancelled</option>
            </select>
            <button class="btn btn-primary" type="submit">Update</button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>
    </div>
  </body>
</html>
